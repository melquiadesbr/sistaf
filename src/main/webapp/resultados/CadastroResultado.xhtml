<ui:composition template="/WEB-INF/template/LayoutPadrao.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:o="http://omnifaces.org/ui">
	
    
    <ui:define name="corpo">
     
    	<f:metadata>
    		<f:event listener="#{cadastroResultadoBean.inicializar}" type="preRenderView" />
    		<f:event listener="#{pesquisaTafsBean.pesquisar}" type="preRenderView"/>
    	</f:metadata>
    
    	
		<h:form id="frmCadastroTaf">
			
	    	<h1>Incluir Militar em TAF</h1>
	    	
	    	<p:messages autoUpdate="true" closable="true" />
	    
	    	<p:toolbar style="margin-top: 20px">
	    		
	    		<p:toolbarGroup>
	    			
		    		<p:selectOneMenu id="taf" value="#{cadastroResultadoBean.resultado.taf}">
		    			<f:ajax event="change" render="codigo, frmCadastroResultado:resultadosTable" listener="#{cadastroResultadoBean.carregarResultados}" />
		    			<f:selectItem itemValue="" itemLabel="Selecione o TAF"  />
		    			<f:selectItems value="#{cadastroResultadoBean.tafsLista}" var="taf" 
		    				itemValue="#{taf}" itemLabel="#{taf.numero}º Taf de #{taf.anoTaf} / #{taf.chamada}ª Ch. / Dia #{taf.dia}" />
		    		</p:selectOneMenu>
		    		<p:selectOneMenu id="militar" value="#{cadastroResultadoBean.resultado.militar}">
		    			<f:selectItem itemValue="" itemLabel="Selecione o Militar"  />
		    			<f:selectItems value="#{cadastroResultadoBean.militaresLista}" var="militar" 
		    				itemValue="#{militar}" itemLabel="#{militar.nomeGuerra} - #{militar.patenteAbr}" />
		    		</p:selectOneMenu>
		    		<p:selectOneMenu id="padrao_de_desempenho" value="#{cadastroResultadoBean.resultado.padraoDesempenho}">
		    			<f:selectItem itemLabel="PBD" itemValue="PBD"></f:selectItem>
		    			<f:selectItem itemLabel="PAD" itemValue="PAD"></f:selectItem>
		    		</p:selectOneMenu>
		    	</p:toolbarGroup>
		    	<p:toolbarGroup>
		    		<p:inputText id="codigo" size="20" onchange="javascript:document.getElementById('botaoSalvar').click()" maxlength="20" value="#{cadastroResultadoBean.resultado.codBarra}" />
		    		<p:commandButton value="Registrar Código"  id="botaoSalvar" action="#{cadastroResultadoBean.salvar}" 
	    				update="codigo, frmCadastroResultado:resultadosTable"
	    			/>
		    	</p:toolbarGroup>
		    	<p:toolbarGroup style="float:right;">
				    <p:outputLabel value="* TAF Alternativo" for="tafAlternativo"/>
			        <p:selectOneRadio id="tafAlternativo" value="#{cadastroResultadoBean.resultado.tafAlternativo}">
			            <f:selectItem itemLabel="Não" itemValue="false" />
			            <f:selectItem itemLabel="Sim" itemValue="true" />
			        </p:selectOneRadio>
				</p:toolbarGroup>
	    	</p:toolbar>
	    	
	    </h:form>
	    
	    <h:form id="frmCadastroResultado">
	    	
	    	<br />
	    	<br />
	    	<h1>Lançar Resultado de TAF</h1>
	    	
	    	<p:toolbar style="margin-top: 20px">
	        	<p:toolbarGroup>
	        		<p:commandButton value="Salvar Todos" id="botaoSalvarTodos" action="#{cadastroResultadoBean.salvarLista}" 
	    				update="@form" style="margin-right:50px"
	    			/>
	        	</p:toolbarGroup>
	        	<p:toolbarGroup>
	        		<p:selectOneMenu id="indiceCorridaParaRegistro" value="#{cadastroResultadoBean.indiceCorridaParaRegistro}">
		    			<f:selectItem itemLabel="1700" itemValue="1700"></f:selectItem>
		    			<f:selectItem itemLabel="1750" itemValue="1750"></f:selectItem>
		    			<f:selectItem itemLabel="1800" itemValue="1800"></f:selectItem>
		    			<f:selectItem itemLabel="1850" itemValue="1850"></f:selectItem>
		    			<f:selectItem itemLabel="1900" itemValue="1900"></f:selectItem>
		    			<f:selectItem itemLabel="1950" itemValue="1950"></f:selectItem>
		    			<f:selectItem itemLabel="2000" itemValue="2000"></f:selectItem>
		    			<f:selectItem itemLabel="2050" itemValue="2050"></f:selectItem>
		    			<f:selectItem itemLabel="2100" itemValue="2100"></f:selectItem>
		    			<f:selectItem itemLabel="2150" itemValue="2150"></f:selectItem>
		    			<f:selectItem itemLabel="2200" itemValue="2200"></f:selectItem>
		    			<f:selectItem itemLabel="2250" itemValue="2250"></f:selectItem>
		    			<f:selectItem itemLabel="2300" itemValue="2300"></f:selectItem>
		    			<f:selectItem itemLabel="2350" itemValue="2350"></f:selectItem>
		    			<f:selectItem itemLabel="2400" itemValue="2400"></f:selectItem>
		    			<f:selectItem itemLabel="2450" itemValue="2450"></f:selectItem>
		    			<f:selectItem itemLabel="2500" itemValue="2500"></f:selectItem>
		    			<f:selectItem itemLabel="2550" itemValue="2550"></f:selectItem>
		    			<f:selectItem itemLabel="2600" itemValue="2600"></f:selectItem>
		    			<f:selectItem itemLabel="2650" itemValue="2650"></f:selectItem>
		    			<f:selectItem itemLabel="2700" itemValue="2700"></f:selectItem>
		    			<f:selectItem itemLabel="2750" itemValue="2750"></f:selectItem>
		    			<f:selectItem itemLabel="2800" itemValue="2800"></f:selectItem>
		    			<f:selectItem itemLabel="2850" itemValue="2850"></f:selectItem>
		    			<f:selectItem itemLabel="2900" itemValue="2900"></f:selectItem>
		    			<f:selectItem itemLabel="2950" itemValue="2950"></f:selectItem>
		    			<f:selectItem itemLabel="3000" itemValue="3000"></f:selectItem>
		    			<f:selectItem itemLabel="3050" itemValue="3050"></f:selectItem>
		    			<f:selectItem itemLabel="3100" itemValue="3100"></f:selectItem>
		    			<f:selectItem itemLabel="3150" itemValue="3150"></f:selectItem>
		    			<f:selectItem itemLabel="3200" itemValue="3200"></f:selectItem>
		    			<f:selectItem itemLabel="3250" itemValue="3250"></f:selectItem>
		    			<f:selectItem itemLabel="3300" itemValue="3000"></f:selectItem>
		    		</p:selectOneMenu>
	        	</p:toolbarGroup>
	        	<p:toolbarGroup>
	        		<p:inputText id="codigoDeBarraParaRegistro" onchange="javascript:document.getElementById('botaoSalvarTodos').click()" size="20"  maxlength="20" value="#{cadastroResultadoBean.codigoDeBarraParaRegistro}"/>
	        	</p:toolbarGroup>
	        	<p:toolbarGroup align="right">
           			<h:commandLink>
                 		<p:graphicImage name="/images/excel.png" width="24"/>
                		<p:dataExporter type="xls" target="resultadosTable" fileName="militares" />
		            </h:commandLink>
		 
		            <h:commandLink>
		                <p:graphicImage name="images/pdf.png" width="24"/>
		                <p:dataExporter type="pdf" target="resultadosTable" fileName="militares" />
		            </h:commandLink>
		 
		            <h:commandLink>
		                <p:graphicImage name="images/csv.png" width="24"/>
		                <p:dataExporter type="csv" target="resultadosTable" fileName="militares" />
		            </h:commandLink>
		            
	        	</p:toolbarGroup>
	        </p:toolbar>
		        
	    	<p:dataTable id="resultadosTable" value="#{cadastroResultadoBean.resultadoLista}" var="resultado" widgetVar="resultadosTable" 
	    		filteredValue="#{cadastroResultadoBean.resultadosFiltradosPrimefaces}" rowIndexVar="rowIndex" 
                paginator="true" rows="10000" style="margin-bottom:20px" paginatorPosition="bottom" editable="true" editMode="cell" 
                paginatorTemplate="{CurrentPageReport}"
        		currentPageReportTemplate="Total encontrado: {totalRecords}">
	    		
	    		<p:column visible="false" headerText="TAF">
	    			<h:outputText value="#{resultado.militar.preTafs}" />
	    		</p:column>
	    		<p:column headerText="Ord" style="text-align: center; width:25px;">
	    			<h:outputText value="#{rowIndex+1}" />
	    		</p:column>
	    		<p:column headerText="Cód" style="text-align: center; width:80px;" sortBy="#{resultado.codBarra}" filterBy="#{resultado.codBarra}" filterMatchMode="contains" filterStyle="width:40px">
	    			<h:outputText value="#{resultado.codBarra}" />
	    		</p:column>
	    		<p:column headerText="A/Q/S" style="width:80px" sortBy="#{resultado.militar.quadro}" filterBy="#{resultado.militar.quadro}" filterMatchMode="contains" filterStyle="width:60px">
	    			<h:outputText value="#{resultado.militar.quadro}"/>
	    		</p:column>
	    		<p:column headerText="OM" style="width:80px; text-align: center;" sortBy="#{resultado.militar.om}" filterBy="#{resultado.militar.om}" filterMatchMode="contains" filterStyle="width:60px">
	    			<h:outputText value="#{resultado.militar.om}"/>
	    		</p:column>
	    		<p:column headerText="Patente" style="width:70px; text-align: right;" sortBy="#{resultado.militar.patente}" filterBy="#{resultado.militar.patenteAbr}" filterMatchMode="contains" filterStyle="width:50px">
	    			<h:outputText value="#{resultado.militar.patenteAbr}"/>
	    		</p:column>
	    		<p:column headerText="Nome de Guerra" style="width:140px;" sortBy="#{resultado.militar.nomeGuerra}" filterBy="#{resultado.militar.nomeGuerra}" filterMatchMode="contains" filterStyle="width:130px">
	    			<h:outputText value="#{resultado.militar.nomeGuerra}"/>
	    		</p:column>
	    		<p:column headerText="Nome Completo" style="width:250px;" sortBy="#{resultado.militar.nomeCompleto}" filterBy="#{resultado.militar.nomeCompleto}" filterMatchMode="contains" filterStyle="width:250px">
	    			<h:outputText value="#{resultado.militar.nomeCompleto}"/>
	    		</p:column>
	    		<p:column headerText="PréTAF" style="width:86px; text-align: center;" sortBy="#{resultado.dtPretafValido}" filterBy="#{resultado.dtPretafValido}" filterMatchMode="contains" filterStyle="width:80px">
	    			<h:outputText value="#{resultado.dtPretafValido}">
	    				<f:convertDateTime pattern="dd/MM/yyyy" />
	    			</h:outputText>
	    		</p:column>
	    		<p:column headerText="Resultado" style="width:86px; text-align: center;" sortBy="#{resultado.resultadoPretaf}" filterBy="#{resultado.resultadoPretaf}" filterMatchMode="contains" filterStyle="width:80px">
	    			<h:outputText value="#{resultado.resultadoPretaf}"/>
	    		</p:column>
	    		<p:column headerText="Idade" style="width:60px; text-align: center;" sortBy="#{resultado.militar.idade}" filterBy="#{resultado.militar.idade}" filterMatchMode="contains" filterStyle="width:30px">
	    			<h:outputText value="#{resultado.militar.idade}"/>
	    		</p:column>
	    	
	    		<p:column headerText="Corrida" style="width:70px; text-align: center;" sortBy="#{resultado.corrida}" filterBy="#{resultado.corrida}" filterMatchMode="contains" filterStyle="width:50px">
	              <p:inputText id="codigo" size="20"  maxlength="20" value="#{resultado.corrida}"  style="width:50px"/>
	            </p:column>
	            
	            <p:column headerText="Barra" style="width:70px; text-align: center;" sortBy="#{resultado.barra}" filterBy="#{resultado.barra}" filterMatchMode="contains" filterStyle="width:50px">
	              <p:inputText id="barra" size="20"  maxlength="20" value="#{resultado.barra}" style="width:50px" />
	            </p:column>
	            
	            <p:column headerText="Flexao" style="width:70px; text-align: center;" sortBy="#{resultado.flexao}" filterBy="#{resultado.flexao}" filterMatchMode="contains" filterStyle="width:50px">
	              <p:inputText id="flexao" size="20"  maxlength="20" value="#{resultado.flexao}" style="width:50px" />
	            </p:column>
	            
	            <p:column headerText="Abd" style="width:70px; text-align: center;" sortBy="#{resultado.abdominal}" filterBy="#{resultado.abdominal}" filterMatchMode="contains" filterStyle="width:50px">
	              <p:inputText id="abdominal" size="20"  maxlength="20" value="#{resultado.abdominal}" style="width:50px"/>
	            </p:column>
	    		
	    		<p:column headerText="PD" style="text-align: center; width: 50px" sortBy="#{resultado.padraoDesempenho}" filterBy="#{resultado.padraoDesempenho}" filterMatchMode="contains" filterStyle="width:30px">
	    			<h:outputText value="#{resultado.padraoDesempenho}" />
	    		</p:column>
	    		
	    		<p:column headerText="Menção" style="text-align: center; width: 70px" sortBy="#{resultado.mencaoAbr}" filterBy="#{resultado.mencaoAbr}" filterMatchMode="contains" filterStyle="width:50px">
	    			<h:outputText value="#{resultado.mencaoAbr}" />
	    		</p:column>
	    		
	    		<p:column headerText="Suf" style="text-align: center; width: 60px" sortBy="#{resultado.suficiencia}" filterBy="#{resultado.suficiencia}" filterMatchMode="contains" filterStyle="width:40px">
	    			<h:outputText value="#{resultado.suficiencia}#{resultado.tafAlternativo == true ? '*' : ''}" />
	    		</p:column>
	    		
	    		<!-- TODO
	    		<p:column headerText="Menção (2018)" sortBy="#{resultado.novaMencao}" style="text-align: center; width: 120px">
	    			<h:outputText value="#{resultado.novaMencaoAbr}" />
	    		</p:column>
	    		
	    		
	    		<p:column headerText="Alternativo" sortBy="#{resultado.tafAlternativo}" style="text-align: center; width: 120px">
	    			<h:outputText value="#{resultado.tafAlternativo}" />
	    		</p:column>
	    		-->
	    		
	    		<p:column headerText="Ações" style="width: 40px; text-align: center" exportable="false">
	    			<p:commandButton icon="ui-icon-trash" title="Excluir" oncomplete="PF('confirmacaoExclusao').show()"
	    					process="@this" update=":frmCadastroResultado:confirmacaoExclusaoDialog">
	    				<f:setPropertyActionListener target="#{cadastroResultadoBean.resultadoSelecionado}" 
	    					value="#{resultado}" />
	    			</p:commandButton>
	    		</p:column>
	    	
	    	</p:dataTable>
	    	
	    	<p:confirmDialog header="Exclusão de Resultado" 
	    		message="Tem certeza que deseja excluir resultado do #{cadastroResultadoBean.resultadoSelecionado.militar.patenteAbr} #{cadastroResultadoBean.resultadoSelecionado.militar.nomeGuerra}?"
	    		widgetVar="confirmacaoExclusao"	id="confirmacaoExclusaoDialog">
	    		<p:button value="Não" onclick="PF('confirmacaoExclusao').hide(); return false;" />
	    		<p:commandButton value="Sim" oncomplete="PF('confirmacaoExclusao').hide();" 
	    			action="#{cadastroResultadoBean.excluir}" process="@this" 
	    			update=":frmCadastroResultado:resultadosTable" id="yesButton" />
	    		</p:confirmDialog>
	    
	    </h:form>
	    	
    </ui:define>
</ui:composition>